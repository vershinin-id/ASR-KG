# ASR-KG
Автоматизированная система расчёта конкурсных групп абитуриента (АСР КГ)

Программа **"Автоматизированная система расчёта конкурсных групп абитуриента (АСР КГ)"** представляет собой инструмент для автоматизации процесса распределения абитуриентов по конкурсным группам, в соответствии с правилами приемной компании 2024 года, с рапределением по приоритетам

## Этапы работы программы:

### 1. Загрузка данных о вакантных местах и абитуриентах:
Пользователь выбирает три файла:
1. **Файл с данными о местах в конкурсных группах** (формат Excel).
2. **Файл с данными абитуриентов** (формат Excel).
3. **Место для сохранения итогового файла** (формат Excel).
Программа поддерживает формат Excel (*.xlsx, *.xls) и позволяет загружать только эти типы файлов.
Обращаю внимание, что программа ссылается на кол-во вакантных мест, и в файле с данными о местах должны быть одинаковые названия конкурсных групп, как и в файле с данными абитуриентов.

### 2. Проверка загруженных данных:
Для успешной работы программы данные должны содержать обязательные столбцы:
- В файле с местами:
    - **Конкурсная группа**: Название или идентификатор конкурсной группы.
    - **Места**: Количество мест в группе.
- В файле с абитуриентами:
    - **Уникальный код**: Идентификатор абитуриента.
    - **ФИО**: Полное имя абитуриента.
    - **Баллы**: Количество баллов абитуриента (для зачисления).
    - **Предмет 1**: Название основного предмета для вступительных экзаменов.
    - **Приоритет**: Приоритет группы, которую абитуриент хочет выбрать (1 — самый высокий).
    - **Конкурсная группа**: Группа, на которую абитуриент подает заявление.
    - **Телефон и Почта**: Контактные данные абитуриента.

### 3. Распределение абитуриентов:
Программа сортирует абитуриентов по уникальному коду, приоритету и баллам:
1. Сортировка по **уникальному коду** и **приоритету** (в порядке возрастания).
2. В рамках одного приоритета абитуриенты сортируются по **баллам** в убывающем порядке.
Распределение происходит в несколько этапов:
1. **По приоритетам:** Каждый абитуриент пытается попасть в группу, в которой он указал наивысший приоритет. Если мест в этой группе недостаточно, абитуриент пытается попасть в группу с более низким приоритетом.
2. **Выталкивание абитуриентов:** Если в конкурсной группе недостаточно мест, абитуриент с более низким баллом может быть вытеснен абитуриентом с более высоким баллом (выталкивание происходит только внутри одной конкурсной группы).

### 4. Запись результатов распределения в Excel файл:
Программа сохраняет результаты распределения в файл формата Excel (*.xlsx):
1. **Вакантные места** — таблица, отображающая количество оставшихся мест в каждой конкурсной группе.
2. **Минимальные баллы** — таблица с минимальными баллами для каждой конкурсной группы (самый низкий балл среди зачисленных абитуриентов).
3. **Абитуриенты по группам** — для каждой конкурсной группы создаётся отдельный лист в Excel с полным списком зачисленных абитуриентов.
4. **Неудачные попытки** — список абитуриентов, которые не были зачислены в ни одну группу. Для каждого такого абитуриента указывается причина (например, отсутствие мест или более низкие баллы).


## Интерфейс

Программа использует графический интерфейс на базе библиотеки **PyQt5**:
- **Кнопки выбора файлов** для загрузки данных о местах, абитуриентах и сохранения результатов.
- **Текстовые метки** для отображения статуса загрузки файлов и подтверждения их правильности.
- **Кнопка для начала распределения** (которая становится доступной только после того, как все файлы загружены).


## Принцип работы распределения абитуриентов

1. Для каждого абитуриента определяется его **первый приоритет**. Если в группе есть места, абитуриент зачисляется в эту группу.
2. Если мест в группе нет, система пытается разместить абитуриента в следующей по приоритету группе.
3. Если в группе есть абитуриенты с более низкими баллами, то с ними может произойти **выталкивание**: абитуриент с более высоким баллом может занять его место.
4. Если абитуриент не был зачислен в ходе всех попыток, он попадает в список **неудачных попыток**.

